# Проект 0.8. Практика. Модуль: ML-6. Отбор и селекция признаков
<table>
  <tr style="vertical-align:middle">
    <!-- <th><img src = 'https://i.hh.ru/logos/svg/hh.ru__min_.svg?v=11032019'></th> -->
    <!-- <th><img style="vertical-align:middle" img src = https://lms.skillfactory.ru/static/rg-theme/images/logo-header.svg></th> -->
    <!-- <th><img style="vertical-align:middle" img src = https://static.tildacdn.com/tild3862-3932-4061-b763-363135393134/logo.svg></th> -->
    <th height=30><img style="vertical-align:middle" img src = https://static.tildacdn.com/tild3736-6663-4331-b065-623334663336/SkillFactory.svg height=20></th>
  </tr>
</table>

## Оглавление
[1. Описание проекта](https://github.com/yaroslav-vorobyov/SF_DST/tree/main/PROJECT-0.8#Описание-проекта)

[2. Какой кейс решаем?](https://github.com/yaroslav-vorobyov/SF_DST/tree/main/PROJECT-0.8#Какой-кейс-решаем)

[3. Краткая информация о данных](https://github.com/yaroslav-vorobyov/SF_DST/tree/main/PROJECT-0.8#Краткая-информация-о-данных)

[4. Этапы работы над проектом](https://github.com/yaroslav-vorobyov/SF_DST/tree/main/PROJECT-0.8#Этапы-работы-над-проектом)

[5. Результаты](https://github.com/yaroslav-vorobyov/SF_DST/tree/main/PROJECT-0.8#Результаты)

  > Перейти прямо к [презентации решения кейса](https://github.com/yaroslav-vorobyov/SF_DST/blob/main/PROJECT-0.8/HW-08.ipynb)

[6. Выводы](https://github.com/yaroslav-vorobyov/SF_DST/tree/main/PROJECT-0.8#Выводы)  

[7. Фидбэк от ментора](https://github.com/yaroslav-vorobyov/SF_DST/tree/main/PROJECT-0.8#Фидбэк-от-ментора)

<br>

## Описание проекта
Целью данной задачи является построение модели классификации пользователей и определение лучшего способа кодирования данных в процессе подготовки данных. Закрепление Comet.ML на практике.

<br>

### Какой кейс решаем?
1 Построить модель машинного обучения, которая на вход будет принимать данные о человеке, а на выходе она должна предсказывать бинарный уровень дохода человека (больше или меньше 50000$ за год) и определить способ кодирования признаков при котором выбранные метрики получаются оптимальными;
2. Произвести логирование графика в Comet.ML.

<br>

**Условия:**
- Решение оформляется только в *Jupyter Notebook*.
- Решение оформляется в соответствии с *ноутбуком-шаблоном*.
- Не следует создавать много ячеек для решения задачи — это проявляет неудобства при проверке.
- Код на *Python* должен быть читаемым. Не забывать про отступы, разметку и комментарии в коде.
- Выводы по каждому этапу оформляются в формате *Markdown* в отдельной ячейке.

<br>

**Метрика качества:**
* В ноутбуке должны быть ответы на следующие вопросы:
<!-- <table>
  <tbody>
    <tr style="vertical-align:middle">
      <td style="background-color: #2e765e; color: white; font-weight: bold">2 балла</td>
      <td style="align:left">Правильность решения задач, логичность построения запросов</td>
    </tr>
    <tr>
      <td style="background-color: #2e765e; color: white; font-weight: bold">2 балла</td>
      <td style="align:left">Читабельность и верное форматирование запросов и кода на Python, наличие комментариев в запросах;<br>Аккуратность оформления решения</td>
    </tr>
    <tr>
      <td style="background-color: #2e765e; color: white; font-weight: bold">2 балла</td>
      <td style="align:left">Логичность и полнота выводов</td>
    </tr>
    <tr>
      <td style="background-color: #2e765e; color: white; font-weight: bold">2 балла</td>
      <td style="align:left">Дополнительные исследования данных</td>
    </tr>
  </tbody>
</table> -->

Для оценки качества модели — точности прогнозов, сделанных моделью — мы будем использовать метрику `accuracy`.
Accuracy (достоверность) — доля правильных ответов модели среди всех ответов. Правильные ответы — это истинно положительные (**True Positive, TP**) и истинно отрицательные ответы (**True Negative, TN**).

Также мы спрогнозируем вероятность принадлежности к классу и на основе этого вычислим метрику как площадь по графиком ROC.
Одной из самых популярных метрик для задачи классификации является ROC-кривая. 

#### <center>ROC = Receiver Operating Characteristic</center>

Эта кривая наглядно показывает зависимость доли истинно позитивных срабатываний (**TPR**) от доли ложно позитивных срабатываний (**FPR**) при изменении порога классификации. Чем больше площадь под этим графиком, тем лучше набор данных выбранный для построения модели.
В нашем случае, это **OneHotEncoding** или **LabelEncoding**.

<br>

**Что на практике:**
-   Учусь писать отличный код на Python;
-   Учусь отрабатывать взаимодействие с внешней системой отслеживания экспериментов - Comet.ML;
-   Учусь сравнивать эксперименты с точки зрения метрик, параметров;
-   Учусь кодировать данные методами OneHotEncoding или LabelEncoding;
-   Учусь строить модели логистической регресии;
-   Учусь строить ROC-кривую;
-   Учусь следить за моделью от создания до вывода в продакшен;
-   Учусь делиться своим проектом, оставить проект приватным или сделать его общедоступным;
-   Учусь эффективно работать с IDE VSCode;
-   Повышаю квалификацию по методам преобразования и очистки данных; 
-   Повышаю квалификацию с GitHub.

:arrow_up:[к оглавлению](https://github.com/yaroslav-vorobyov/SF_DST/tree/main/PROJECT-0.8#Оглавление)

<br>

### Краткая информация о данных

В данном проекте первоначальные данные представлены в виде 2 датасетов (тренировочный и тестовый) размером: свыше 32500 строк, 13 столбцов, типа object, float64 и int64, в отдельных столбцах пропуски и дубликаты присутствуют. В связи с этим необходимо более детально проанализировать структуру первоначальных данных, сделать выводы о дальнейших преобразованиях. Построить обучающую модель, залогировать результаты этапов.

* первоначальные данные:
  * https://www.dropbox.com/s/1hfrcm09qtvoeoz/train.csv - тренировочный датасет;
  * https://www.dropbox.com/s/jj7c8r0x57zda0a/test.csv - тестовый датасет.

<br>

### Требования для работы
*   Основой интерпретатор - Python 3.10 (у меня взят из Windows App Store для максимальной бесшовной интеграции с VSCode);
*   Дополнительные требования перечислены в requirements.txt (получены командой pip freeze > requirements.txt);
*   Установка всех недостающих дополнительных компонент:

            pip install -r requirements.txt

*   В проекте используется:
    
    *   Kaggle API:
            
            https://github.com/Kaggle/kaggle-api

    *   Comet.ML API & SDK

            https://www.comet.com/docs/v2/guides/tracking-ml-training/configuring-comet/
            
            https://www.comet.com/docs/v2/api-and-sdk/python-sdk/advanced/configuration/#configuration-variables 

:arrow_up:[к оглавлению](https://github.com/yaroslav-vorobyov/SF_DST/tree/main/PROJECT-0.8#Оглавление)

<br>

### Этапы работы над проектом
- Ознакомление с описанием задачи;
- Знакомство с данными;
- Импортирование необходимых библиотек и платформы Comet для логгирования;
- Оценка сбалансированности выборок;
- Обработка данных: исключение данных из выборки (пропуски, выбросы), создание новых признаков;
- Кодировка категориальных признаков методами OneHotEncoding и LabelEncoding, создание 2-ух разных тренинговых датасетов;
- Построение обучающих моделей на разных типах закодированных данных с поэтапным логированием;
- Расчет метрики accuracy для обоих моделей, расчет прогнозов вероятности принадлежности к к классам, построение ROC-кривых моделей, вычисление метрики площади под ROC кривой;
- Проверка соответствия написанного кода стандарту PEP8;
- Оформление проекта;
- Загрузка проекта на GitHub.

<br>

### Результаты:

Проект c корректным выполнением кейса ["Практическая работа"](https://github.com/yaroslav-vorobyov/SF_DST/blob/main/PROJECT-0.8/HW-08.ipynb).

Метрики:
1. Accuracy:
  * LabelEncoding data = 0.803
  * OneHotEncoder data = 0.857

2. ROC-AUC:
  * на тестовой выборке OneHotEncoding: 0.904
  * на тестовой выборке LabelEncoding: 0.815

<br>

### Выводы
В процессе выполнения кейса первоначальные данные были:
* Внимательно изучены исходные данные и проанализированы;
* Проведена подготовка данных к использованию: преобразование, исключение, создание признаков;
* Проведён обучающий эксперимент, произведена фиксация и логирование результатов;

**Лучшие результаты показывает датасет с кодировкой OneHotEncoding.**

<br>

:arrow_up:[к оглавлению](https://github.com/yaroslav-vorobyov/SF_DST/tree/main/PROJECT-0.8#Оглавление)

<br>

### Фидбэк от ментора
<!-- * Фидбэк PROJECT-0.8.url - содержит ссылку на отзыв, файл находится на Google Drive ментора -->
* Фидбэк PROJECT-0.8.pdf - версия отзыва с полным оформлением, если по ссылке файл будет удалён
* Фидбэк PROJECT-0.8.txt - текстовая версия отзыва, если по ссылке файл будет удалён

Перейти к [отзыву](https://github.com/yaroslav-vorobyov/SF_DST/tree/main/PROJECT-0.8/docs)

<br>

Если информация по этому проекту покажется вам интересной или полезной, то я буду очень вам благодарен, если отметите репозиторий и профиль ⭐️⭐️⭐️-дами.